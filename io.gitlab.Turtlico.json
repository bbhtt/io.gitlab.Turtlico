{
    "app-id": "io.gitlab.Turtlico",
    "runtime": "org.gnome.Platform",
    "runtime-version": "41",
    "sdk": "org.gnome.Sdk",
    "command": "turtlico",
    "finish-args": [
        "--share=network",
        "--share=ipc",
        "--socket=x11",
        "--socket=wayland",
        "--socket=pulseaudio",
        "--filesystem=xdg-run/dconf",
        "--filesystem=~/.config/dconf:ro",
        "--filesystem=host",
        "--talk-name=ca.desrt.dconf",
        "--device=all",
        "--env=DCONF_USER_CONFIG_DIR=.config/dconf",
        "--env=GPIOZERO_PIN_FACTORY=native",
        "--env=PYTHONUNBUFFERED=1"
    ],
    "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/lib/debug",
        "/man",
        "/share/doc",
        "/share/gtk-doc",
        "/share/man",
        "/share/pkgconfig",
        "/share/vala",
        "*.la",
        "*.a"
    ],
    "modules": [
        {
            "name": "tcl",
            "sources": [{
                "type": "archive",
                "url": "http://prdownloads.sourceforge.net/tcl/tcl8.6.12-src.tar.gz",
                "sha256": "26c995dd0f167e48b11961d891ee555f680c175f7173ff8cb829f4ebcde4c1a6"
            }],
            "subdir": "unix",
            "config-opts": [
                "--enable-threads"
            ],
            "post-install": [
                "chmod 755 /app/lib/libtcl8.6.so"
            ]
        },
        {
            "name": "tk",
            "sources": [{
                "type": "archive",
                "url": "http://prdownloads.sourceforge.net/tcl/tk8.6.12-src.tar.gz",
                "sha256": "12395c1f3fcb6bed2938689f797ea3cdf41ed5cb6c4766eec8ac949560310630"
            }],
            "subdir": "unix",
            "config-opts": [
                "--with-x",
                "--enable-threads"
            ],
            "post-install": [
                "chmod 755 /app/lib/libtk8.6.so"
            ]
        },
        {
            "name": "python3",
            "config-opts": [
                "--enable-ipv6",
                "--with-lto",
                "--with-system-ffi",
                "--with-system-libmpdec",
                "--with-system-expat"
            ],
            "cleanup": [
                "/bin/2to3*",
                "/bin/easy_install*",
                "/bin/idle*",
                "/bin/python*-config",
                "/bin/pyvenv*",
                "/bin/pydoc*",
                "/include",
                "/share",
                "/lib/pkgconfig",
                "/lib/python*/config-*",
                "/lib/python*/test",
                "/lib/python*/distutils/tests",
                "/lib/python*/ctypes/test",
                "/lib/python*/sqlite3/test",
                "/lib/python*/lib2to3/tests",
                "/lib/python*/tkinter/test",
                "/lib/python*/unittest/test",
                "/lib/python*/lib-dynload/_*_test.*.so",
                "/lib/python*/lib-dynload/_test*.*.so",
                "*.pyc",
                "__pycache__",
                "*.exe"
            ],
            "sources": [{
                "type": "archive",
                "url": "https://www.python.org/ftp/python/3.9.9/Python-3.9.9.tar.xz",
                "sha256": "06828c04a573c073a4e51c4292a27c1be4ae26621c3edc7cf9318418ce3b6d27"
            }]
        },
        {
            "name": "python3-Pillow",
            "buildsystem": "simple",
            "build-commands": [
                "LDFLAGS=-L`echo /usr/lib/${FLATPAK_ARCH}-linux-*` pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} Pillow"
            ],
            "sources": [{
                "type": "file",
                "url": "https://files.pythonhosted.org/packages/7d/2a/2fc11b54e2742db06297f7fa7f420a0e3069fdcf0e4b57dfec33f0b08622/Pillow-8.4.0.tar.gz",
                "sha256": "b8e2f83c56e141920c39464b852de3719dfbfb6e3c99a2d8da0edf4fb33176ed"
            }]
        },
        {
            "name": "python3-gpiozero",
            "buildsystem": "simple",
            "build-commands": [
                "pip3 install --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} gpiozero"
            ],
            "sources": [{
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/b3/ca/688824a06e8c4d04c7d2fd2af2d8da27bed51af20ee5f094154e1d680334/colorzero-2.0.tar.gz",
                    "sha256": "e7d5a5c26cd0dc37b164ebefc609f388de24f8593b659191e12d85f8f9d5eb58"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/86/e1/88d1fde5ce042a12e231ff032ae1aace89670ad15497672b28a6eb5699e9/gpiozero-1.6.2.tar.gz",
                    "sha256": "0eb95a9db372146813276f92de7f43c883a3e9fe69597fc3d29c04ef3d5d5f9e"
                }
            ]
        },
        {
            "name": "python3-site-packages",
            "buildsystem": "simple",
            "build-commands": [
                "echo '/usr/lib/python3.9/site-packages/' > /app/lib/python3.9/site-packages/usr.pth"
            ]
        },
        {
            "name": "turtlico",
            "builddir": true,
            "buildsystem": "meson",
            "config-opts": [],
            "sources": [
                {
                    "type": "git",
                    "url": "https://gitlab.com/turtlico/turtlico.git",
                    "tag": "1.0.0",
                    "commit": "98b15b0afef864c102511d9e48cf18bb05a8d08a"
                }
            ]
        }
    ]
}
